<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Interactive Calendar</title>
        <script src="https://cdn.tailwindcss.com"></script>
    </head>
    <body class="flex h-screen items-center justify-center bg-gray-900 text-lg text-white">
        <div class="flex h-[400px] w-[1000px] overflow-hidden rounded-lg bg-gray-800 shadow-lg">
            <div class="flex w-48 flex-col bg-gray-700 p-4">
                <h3 class="mb-2 text-lg font-bold">
                    {% if user_pic %}
                    <img src="user_pic" alt="Profile Image" class="h-8 w-8 rounded-full" />
                    {% else %}
                    <img
                        src="/static/images/profile_pictures/profile_picture.jpg"
                        alt="Default Image"
                        class="h-8 w-8 rounded-full"
                    />
                    {% endif %}{{ username }}
                </h3>
                <p class="text-l mb-1 text-gray-300">{{ event.title }}</p>
                <p class="text-l mb-2 text-gray-300">ðŸ•’ {{ event.duration }} {{ event.time_type.value }}</p>
                <p class="text-l mb-3 flex items-center text-gray-300">
                    <a class="flex items-center" target="_blank">
                        <svg
                            xmlns="http://www.w3.org/2000/svg"
                            fill="none"
                            viewBox="0 0 120 75"
                            width="20px"
                            class="mr-1"
                        >
                            <path fill="#00832d" d="M49.5 36l8.53 9.75 11.47 7.33 2-17.02-2-16.64-11.69 6.44z" />
                            <path fill="#0066da" d="M0 51.5V66c0 3.315 2.685 6 6 6h14.5l3-10.96-3-9.54-9.95-3z" />
                            <path fill="#e94235" d="M20.5 0L0 20.5l10.55 3 9.95-3 2.95-9.41z" />
                            <path fill="#2684fc" d="M20.5 20.5H0v31h20.5z" />
                            <path
                                fill="#00ac47"
                                d="M82.6 8.68L69.5 19.42v33.66l13.16 10.79c1.97 1.54 4.85.135 4.85-2.37V11c0-2.535-2.945-3.925-4.91-2.32zM49.5 36v15.5h-29V72h43c3.315 0 6-2.685 6-6V53.08z"
                            />
                            <path fill="#ffba00" d="M63.5 0h-43v20.5h29V36l20-16.57V6c0-3.315-2.685-6-6-6z" />
                        </svg>
                        Google meet</a
                    >
                </p>
                <div id="selectedDates" class="text-l mt-auto text-gray-300"></div>
                <div id="selectedTime" class="text-l mt-1 text-gray-300"></div>
            </div>
            <div class="flex-grow p-4">
                <div class="mb-2 flex items-center justify-between">
                    <button id="prevMonth" class="text-gray-400 hover:text-white">&lt;</button>
                    <div id="monthYear" class="text-sm font-bold"></div>
                    <button id="nextMonth" class="text-gray-400 hover:text-white">&gt;</button>
                </div>
                <div class="text-l mb-1 grid grid-cols-7 gap-1 text-center font-semibold text-gray-400">
                    <div>SUN</div>
                    <div>MON</div>
                    <div>TUE</div>
                    <div>WED</div>
                    <div>THU</div>
                    <div>FRI</div>
                    <div>SAT</div>
                </div>
                <div id="calendarDays" class="grid grid-cols-7 gap-1 text-center"></div>
                <div class="mt-2 flex justify-end">
                    <button id="toggleView12h" class="mr-2 rounded bg-gray-700 px-2 py-1 text-xs">12h</button>
                    <button id="toggleView24h" class="rounded bg-gray-700 px-2 py-1 text-xs">24h</button>
                </div>
            </div>
            <div id="timeSlots" class="w-48 overflow-y-auto bg-gray-700 p-4 text-center text-xs"></div>
        </div>

        <script>
            let currentDate = new Date();
            let is24HourFormat = false;
            let selectedDate = null; // Ð˜Ð·Ð¼ÐµÐ½ÐµÐ½Ð¾ Ð½Ð° Ð¾Ð´Ð½Ñƒ Ð¿ÐµÑ€ÐµÐ¼ÐµÐ½Ð½ÑƒÑŽ
            let selectedTime = null;

            function generateCalendar(year, month) {
                const firstDay = new Date(year, month, 1);
                const lastDay = new Date(year, month + 1, 0);
                const daysContainer = document.getElementById("calendarDays");
                const monthYear = document.getElementById("monthYear");

                monthYear.textContent = `${firstDay.toLocaleString("default", { month: "long" })} ${year}`;
                daysContainer.innerHTML = "";

                for (let i = 0; i < firstDay.getDay(); i++) {
                    daysContainer.innerHTML += '<div class="text-gray-600 p-1">.</div>';
                }

                for (let day = 1; day <= lastDay.getDate(); day++) {
                    const dayElement = document.createElement("div");
                    dayElement.textContent = day;
                    const dateString = `${year}-${String(month + 1).padStart(2, "0")}-${String(day).padStart(2, "0")}`;
                    dayElement.className = "p-1 text-xs hover:bg-gray-700 cursor-pointer";
                    if (selectedDate === dateString) {
                        // Ð˜Ð·Ð¼ÐµÐ½ÐµÐ½Ð¾ Ð½Ð° Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÑƒ Ð¾Ð´Ð½Ð¾Ð¹ Ð´Ð°Ñ‚Ñ‹
                        dayElement.classList.add("bg-blue-500", "text-white", "rounded");
                    }
                    if (
                        year === currentDate.getFullYear() &&
                        month === currentDate.getMonth() &&
                        day === currentDate.getDate()
                    ) {
                        dayElement.classList.add("ring-2", "ring-white", "rounded");
                    }
                    dayElement.addEventListener("click", () => selectDate(dateString)); // Ð˜Ð·Ð¼ÐµÐ½ÐµÐ½Ð¾ Ð½Ð° selectDate
                    daysContainer.appendChild(dayElement);
                }
                updateSelectedInfo();
            }

            function generateTimeSlots() {
                const timeSlotsContainer = document.getElementById("timeSlots");
                timeSlotsContainer.innerHTML = "";

                const format = is24HourFormat ? "2-digit" : "numeric";
                const options = { hour: format, minute: "2-digit", hour12: !is24HourFormat };

                for (let hour = 0; hour < 24; hour++) {
                    const time = new Date(2024, 0, 1, hour, 0);
                    const timeSlot = document.createElement("div");
                    const timeString = time.toLocaleTimeString("en-US", options);
                    timeSlot.className =
                        "text-center py-2 mb-2 text-gray-400 cursor-pointer rounded-lg border border-gray-800 p-4 transition duration-150 hover:bg-gray-800";
                    if (timeString === selectedTime) {
                        timeSlot.classList.add("bg-blue-500", "text-white");
                    }
                    timeSlot.textContent = timeString;
                    timeSlot.addEventListener("click", () => selectTime(timeString));
                    timeSlotsContainer.appendChild(timeSlot);
                }
            }

            function selectDate(dateString) {
                // Ð£ÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ° Ð²Ñ‹Ð±Ñ€Ð°Ð½Ð½Ð¾Ð¹ Ð´Ð°Ñ‚Ñ‹
                selectedDate = dateString;
                generateCalendar(currentDate.getFullYear(), currentDate.getMonth());
            }

            function selectTime(timeString) {
                selectedTime = timeString;
                generateTimeSlots();
                updateSelectedInfo();
            }

            function updateSelectedInfo() {
                const selectedDateElement = document.getElementById("selectedDates");
                const selectedTimeElement = document.getElementById("selectedTime");

                selectedDateElement.textContent = `Selected date: ${selectedDate ? selectedDate : "None"}`;
                selectedTimeElement.textContent = selectedTime ? `Selected time: ${selectedTime}` : "";
            }

            function updateCalendar() {
                generateCalendar(currentDate.getFullYear(), currentDate.getMonth());
                generateTimeSlots();
            }

            document.getElementById("prevMonth").addEventListener("click", () => {
                currentDate.setMonth(currentDate.getMonth() - 1);
                updateCalendar();
            });

            document.getElementById("nextMonth").addEventListener("click", () => {
                currentDate.setMonth(currentDate.getMonth() + 1);
                updateCalendar();
            });

            document.getElementById("toggleView12h").addEventListener("click", () => {
                is24HourFormat = false;
                generateTimeSlots();
            });

            document.getElementById("toggleView24h").addEventListener("click", () => {
                is24HourFormat = true;
                generateTimeSlots();
            });

            updateCalendar();
        </script>
    </body>
</html>
