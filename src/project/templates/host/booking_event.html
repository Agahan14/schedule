<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Interactive Calendar</title>
        <script src="https://cdn.tailwindcss.com"></script>
    </head>
    <body class="flex h-screen items-center justify-center bg-gray-900 text-lg text-white">
        <div class="flex h-[400px] w-full max-w-[1000px] overflow-hidden rounded-lg bg-gray-800 shadow-lg">
            <div class="flex w-52 flex-col bg-gray-700 p-4">
                <h3 class="items-left flex text-lg font-bold">
                    <img
                        src="/static/images/profile_pictures/profile_picture.jpg"
                        alt="Default Image"
                        class="mb-2 mr-2 h-8 w-8 rounded-full"
                    />
                    {{userFullname}}
                </h3>
                <hr class="border-gray-600" />
                <p class="text-l mb-4 text-xl text-gray-300">{{ event.title }}</p>
                <p class="items-left text-l mb-2 flex text-sm text-gray-300">
                    <svg
                        xmlns="http://www.w3.org/2000/svg"
                        viewBox="0 -960 960 960"
                        width="16px"
                        fill="#B7B7B7"
                        class="mr-1"
                    >
                        <path
                            d="m612-292 56-56-148-148v-184h-80v216l172 172ZM480-80q-83 0-156-31.5T197-197q-54-54-85.5-127T80-480q0-83 31.5-156T197-763q54-54 127-85.5T480-880q83 0 156 31.5T763-763q54 54 85.5 127T880-480q0 83-31.5 156T763-197q-54 54-127 85.5T480-80Zm0-400Zm0 320q133 0 226.5-93.5T800-480q0-133-93.5-226.5T480-800q-133 0-226.5 93.5T160-480q0 133 93.5 226.5T480-160Z"
                        />
                    </svg>
                    {{ event.duration }} {{ event.time_type.value }}
                </p>
                <a href="{{ event.url }}" class="items-left flex text-sm text-blue-500 hover:underline" target="_blank">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 120 75" width="18px" class="mr-1">
                        <path fill="#00832d" d="M49.5 36l8.53 9.75 11.47 7.33 2-17.02-2-16.64-11.69 6.44z" />
                        <path fill="#0066da" d="M0 51.5V66c0 3.315 2.685 6 6 6h14.5l3-10.96-3-9.54-9.95-3z" />
                        <path fill="#e94235" d="M20.5 0L0 20.5l10.55 3 9.95-3 2.95-9.41z" />
                        <path fill="#2684fc" d="M20.5 20.5H0v31h20.5z" />
                        <path
                            fill="#00ac47"
                            d="M82.6 8.68L69.5 19.42v33.66l13.16 10.79c1.97 1.54 4.85.135 4.85-2.37V11c0-2.535-2.945-3.925-4.91-2.32zM49.5 36v15.5h-29V72h43c3.315 0 6-2.685 6-6V53.08z"
                        />
                        <path fill="#ffba00" d="M63.5 0h-43v20.5h29V36l20-16.57V6c0-3.315-2.685-6-6-6z" />
                    </svg>
                    Google Meet
                </a>
                <div id="selectedDates" class="text-l mt-auto text-gray-300"></div>
                <div id="selectedTime" class="text-l mt-1 text-gray-300"></div>
            </div>
            <div class="flex-grow p-4">
                <div class="mb-2 flex items-center justify-between">
                    <button
                        id="prevMonth"
                        class="rounded-lg border-gray-800 px-2 text-gray-400 transition duration-150 hover:bg-gray-400 hover:text-white"
                    >
                        &lt;
                    </button>
                    <div id="monthYear" class="text-l font-bold"></div>
                    <button
                        id="nextMonth"
                        class="rounded-lg border-gray-800 px-2 text-gray-400 transition duration-150 hover:bg-gray-400 hover:text-white"
                    >
                        &gt;
                    </button>
                </div>
                <div class="text-l mb-1 grid grid-cols-7 gap-1 pb-2 text-center font-semibold text-gray-400">
                    <div>SUN</div>
                    <div>MON</div>
                    <div>TUE</div>
                    <div>WED</div>
                    <div>THU</div>
                    <div>FRI</div>
                    <div>SAT</div>
                </div>
                <div id="calendarDays" class="grid grid-cols-7 gap-1 text-center"></div>
                <div class="mt-2">
                    <a href="/host/{{username}}/{{event.id}}/confirmation">
                        <button
                            id="confirm"
                            class="w-full rounded-lg bg-gray-700 py-2 text-white transition duration-150 hover:bg-blue-600"
                        >
                            Confirm
                        </button></a
                    >
                </div>
            </div>
            <div class="flex w-48 flex-col">
                <div class="border-black-600 flex justify-center bg-gray-700">
                    <div class="my-2 flex items-center rounded-lg border border-zinc-600">
                        <button
                            id="toggleView24h"
                            class="time-format-button m-1 rounded px-6 py-1 text-sm transition duration-150 hover:bg-gray-600 active:text-white"
                        >
                            24h
                        </button>
                        <div class="mx-2 h-8 border-l border-zinc-600"></div>
                        <button
                            id="toggleView12h"
                            class="time-format-button m-1 rounded px-6 py-1 text-sm transition duration-150 hover:bg-gray-600 active:text-white"
                        >
                            12h
                        </button>
                    </div>
                </div>
                <hr class="border-gray-600" />
                <div id="timeSlots" class="h-full overflow-y-auto bg-gray-700 p-2 text-center text-xs"></div>
            </div>
        </div>
        <!-- Made with God's help -->
        <script>
            let currentDate = new Date();
            let is24HourFormat = true;
            let selectedDate = null;
            let selectedTime = null;

            function generateCalendar(year, month) {
                const firstDay = new Date(year, month, 1);
                const lastDay = new Date(year, month + 1, 0);
                const daysContainer = document.getElementById("calendarDays");
                const monthYear = document.getElementById("monthYear");

                monthYear.textContent = `${firstDay.toLocaleString("default", { month: "long" })} ${year}`;
                daysContainer.innerHTML = "";

                for (let i = 0; i < firstDay.getDay(); i++) {
                    daysContainer.innerHTML += '<div class="text-gray-600 p-1">.</div>';
                }

                for (let day = 1; day <= lastDay.getDate(); day++) {
                    const dayElement = document.createElement("div");
                    dayElement.textContent = day;
                    const dateString = `${year}-${String(month + 1).padStart(2, "0")}-${String(day).padStart(2, "0")}`;
                    dayElement.className =
                        "p-2 text-l border border-gray-800 transition rounded-lg duration-150 hover:bg-gray-400 cursor-pointer";
                    if (selectedDate === dateString) {
                        dayElement.classList.add("bg-blue-500", "text-white", "rounded");
                    }
                    if (
                        year === currentDate.getFullYear() &&
                        month === currentDate.getMonth() &&
                        day === currentDate.getDate()
                    ) {
                        dayElement.classList.add("ring-2", "ring-white", "rounded");
                    }
                    dayElement.addEventListener("click", () => selectDate(dateString));
                    daysContainer.appendChild(dayElement);
                }
                updateSelectedInfo();
            }

            function generateTimeSlots() {
                const timeSlotsContainer = document.getElementById("timeSlots");
                timeSlotsContainer.innerHTML = "";

                const format = is24HourFormat ? "2-digit" : "numeric";
                const options = { hour: format, minute: "2-digit", hour12: !is24HourFormat };

                for (let hour = 0; hour < 24; hour++) {
                    const time = new Date(2024, 0, 1, hour, 0);
                    const timeSlot = document.createElement("div");
                    const timeString = time.toLocaleTimeString("en-US", options);
                    timeSlot.className =
                        "text-center py-2 mb-2 text-gray-400 cursor-pointer rounded-lg border border-gray-800 p-4 transition duration-150 hover:bg-gray-800";
                    if (timeString === selectedTime) {
                        timeSlot.classList.add("bg-blue-500", "text-white");
                    }
                    timeSlot.textContent = timeString;
                    timeSlot.addEventListener("click", () => selectTime(timeString));
                    timeSlotsContainer.appendChild(timeSlot);
                }
            }

            function selectDate(dateString) {
                selectedDate = dateString;
                generateCalendar(currentDate.getFullYear(), currentDate.getMonth());
            }

            function selectTime(timeString) {
                selectedTime = timeString;
                generateTimeSlots();
                updateSelectedInfo();
            }

            function updateSelectedInfo() {
                const selectedDateElement = document.getElementById("selectedDates");
                const selectedTimeElement = document.getElementById("selectedTime");

                selectedDateElement.textContent = `Selected date: ${selectedDate ? selectedDate : "None"}`;
                selectedTimeElement.textContent = selectedTime ? `Selected time: ${selectedTime}` : "";
            }

            function updateCalendar() {
                generateCalendar(currentDate.getFullYear(), currentDate.getMonth());
                generateTimeSlots();
            }

            document.getElementById("prevMonth").addEventListener("click", () => {
                currentDate.setMonth(currentDate.getMonth() - 1);
                updateCalendar();
            });

            document.getElementById("nextMonth").addEventListener("click", () => {
                currentDate.setMonth(currentDate.getMonth() + 1);
                updateCalendar();
            });

            document.getElementById("toggleView12h").addEventListener("click", () => {
                is24HourFormat = false;
                updateActiveButton("toggleView12h");
                generateTimeSlots();
            });

            document.getElementById("toggleView24h").addEventListener("click", () => {
                is24HourFormat = true;
                updateActiveButton("toggleView24h");
                generateTimeSlots();
            });

            function updateActiveButton(activeButtonId) {
                const buttons = document.querySelectorAll(".time-format-button");
                buttons.forEach((button) => {
                    button.classList.remove("bg-blue-500", "text-white");
                    button.classList.add("hover:bg-gray-600");
                });

                const activeButton = document.getElementById(activeButtonId);
                activeButton.classList.add("bg-blue-500", "text-white");
            }

            updateActiveButton("toggleView24h");
            updateCalendar();
        </script>
    </body>
</html>
